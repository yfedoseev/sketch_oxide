# Migration Guide: v0.1.5 → v0.1.6

Welcome to sketch_oxide v0.1.6! This release significantly expands multi-language support and documentation. This guide covers breaking changes, new features, and upgrade steps.

## Summary of Changes

- ✅ **Java support**: Complete (37/41 → 41/41 algorithms)
- ✅ **C# support**: Complete (41/41 algorithms with native binaries)
- ✅ **Documentation**: 4 new comprehensive guides
- ✅ **API stability**: No breaking changes to existing APIs
- ⚠️ **Serialization**: Some algorithms don't support serialization (see below)

## Breaking Changes

### None in Rust Core

All Rust APIs remain backward compatible. Existing code using sketch_oxide v0.1.5 will work unchanged in v0.1.6.

### Language Bindings: Serialization Not Supported

**Affected algorithms in Java and C#:**
- `BinaryFuseFilter` - Use reconstruction from original items instead
- `LearnedBloomFilter` - Train on same data to recreate
- `VacuumFilter` - Reconstruct with insert operations

**Impact**: If your code serializes/deserializes these algorithms, you'll need to change approach.

**Migration Path**:
```java
// BEFORE (v0.1.5 - doesn't work in v0.1.6)
byte[] serialized = filter.serialize();  // May not work
BinaryFuseFilter restored = BinaryFuseFilter.deserialize(serialized);

// AFTER (v0.1.6 - recommended approach)
// Store original item list instead
long[] items = {...};
BinaryFuseFilter filter = new BinaryFuseFilter(items, bitsPerEntry);
// To restore: recreate with same items
BinaryFuseFilter restored = new BinaryFuseFilter(items, bitsPerEntry);
```

## New Features

### Java Support Expanded (v0.1.5: 37/41 → v0.1.6: 41/41)

Added support for 4 new algorithms:
- **NitroSketch** - High-speed network telemetry (sampling-based frequency estimation)
- **LearnedBloomFilter** - ML-enhanced membership testing (70-80% space savings)
- **VacuumFilter** - Dynamic membership with deletions (best among deletion-supporting filters)
- **BinaryFuseFilter** - Ultra-efficient static membership testing

See [ALGORITHM_SELECTION_GUIDE.md](ALGORITHM_SELECTION_GUIDE.md) for when to use each.

### C# Support Complete (All 41 algorithms)

```csharp
// All 41 algorithms now available:
var hll = new HyperLogLog(14);           // Cardinality
var cm = new CountMinSketch(0.01, 0.001); // Frequency
var bf = new BloomFilter(1000, 0.01);     // Membership
var dd = new DDSketch(0.01);              // Quantiles
var swc = new SlidingWindowCounter(3600, 0.01); // Streaming
var mh = new MinHash(128);                // Similarity
var rs = new ReservoirSampling(100);      // Sampling
// ... and 34 more
```

### Documentation Enhancements

**4 new guides added:**

1. **ALGORITHM_SELECTION_GUIDE.md**
   - Decision tree for choosing algorithms
   - Performance comparison matrix
   - Use-case recommendations

2. **INTEGRATION_PATTERNS.md**
   - Real-world examples (DuckDB, Polars, Pandas)
   - Multi-language code samples
   - Integration with existing tools

3. **PERFORMANCE_GUIDE.md**
   - Parameter tuning recommendations
   - Memory vs accuracy trade-offs
   - Platform-specific optimizations

4. **v0.1.5_to_v0.1.6_MIGRATION.md** (this file)
   - Breaking changes and migration paths
   - New features overview

## Upgrade Steps

### Rust

```toml
[dependencies]
sketch_oxide = "0.1.6"  # Update from 0.1.5
```

No code changes needed. All v0.1.5 code works in v0.1.6.

### Python

```bash
pip install --upgrade sketch-oxide==0.1.6
```

No code changes needed.

### Node.js

```bash
npm update sketch-oxide@0.1.6
```

No code changes needed.

### Java

```xml
<!-- Maven -->
<dependency>
    <groupId>com.sketches</groupId>
    <artifactId>sketch-oxide</artifactId>
    <version>0.1.6</version>
</dependency>
```

```gradle
// Gradle
implementation 'com.sketches:sketch-oxide:0.1.6'
```

**Changes:**
- New package: `com.sketches.oxide` (in addition to `com.sketches_oxide.*)
- 4 new algorithm classes added
- **Action**: Review any serialization code for the 3 new unsupported algorithms

### C#

```xml
<PackageReference Include="SketchOxide" Version="0.1.6" />
```

```bash
# NuGet CLI
nuget install SketchOxide -Version 0.1.6
```

**Changes:**
- Version bumped from 0.1.0 to 0.1.6
- 41 algorithms (was incomplete in v0.1.5)
- Native libraries now included
- **Action**: If upgrading from v0.1.5 C#, verify native library loading works on your platform

## Known Issues in v0.1.6

### BinaryFuseFilter, LearnedBloomFilter, VacuumFilter

These algorithms do not support serialization to/from bytes. This is a library limitation, not a bug.

**Workaround**: Store the original data or construction parameters instead.

### Cross-Platform Native Libraries for C#

Currently provided for Linux x86_64. macOS, Windows, and other platforms require building from source or using cross-compilation.

**Workaround**: See [Native Library Building](./dotnet/README.md#building-native-libraries) for your platform.

## Compatibility Matrix

| Language | v0.1.5 Support | v0.1.6 Support | Status |
|----------|---|---|---|
| **Rust** | 41/41 ✓ | 41/41 ✓ | Fully compatible |
| **Python** | 41/41 ✓ | 41/41 ✓ | Fully compatible |
| **Node.js** | 41/41 ✓ | 41/41 ✓ | Fully compatible |
| **Java** | 37/41 | 41/41 ✓ | 4 new algorithms |
| **C#** | Partial | 41/41 ✓ | Complete support |

## Performance Impact

v0.1.6 maintains the same performance characteristics as v0.1.5:

- **No regressions** in existing algorithms
- **New algorithms** meet or exceed reference implementations
- **Memory usage** unchanged for v0.1.5 algorithms

Benchmark results for new algorithms:
- **NitroSketch**: <100ns per update (sampling-based)
- **LearnedBloomFilter**: ~3-5 bits/item (vs 10 bits for Bloom)
- **VacuumFilter**: 12-14 bits/item with dynamic inserts/deletes
- **BinaryFuseFilter**: 9 bits/item for static filters

## Feature Parity Check

Use this table to verify feature parity for your use case:

| Feature | Rust | Python | Node.js | Java | C# |
|---------|------|--------|---------|------|-----|
| Cardinality (5 algos) | ✓ | ✓ | ✓ | ✓ | ✓ |
| Frequency (8 algos) | ✓ | ✓ | ✓ | ✓ | ✓ |
| Membership (9 algos) | ✓ | ✓ | ✓ | ✓ | ✓ |
| Quantiles (5 algos) | ✓ | ✓ | ✓ | ✓ | ✓ |
| Streaming (3 algos) | ✓ | ✓ | ✓ | ✓ | ✓ |
| Similarity (2 algos) | ✓ | ✓ | ✓ | ✓ | ✓ |
| Sampling (2 algos) | ✓ | ✓ | ✓ | ✓ | ✓ |
| Range Filters (3 algos) | ✓ | ✓ | ✓ | ✓ | ✓ |
| Reconciliation (1 algo) | ✓ | ✓ | ✓ | ✓ | ✓ |
| Universal (3 algos) | ✓ | ✓ | ✓ | ✓ | ✓ |
| **Serialization** | Varies | Varies | Varies | Limited | Limited |
| **Merge** | All | All | All | Most | Most |

## Getting Help

- **Questions about algorithms**: See [ALGORITHM_SELECTION_GUIDE.md](./ALGORITHM_SELECTION_GUIDE.md)
- **Integration help**: See [INTEGRATION_PATTERNS.md](./INTEGRATION_PATTERNS.md)
- **Performance tuning**: See [PERFORMANCE_GUIDE.md](./PERFORMANCE_GUIDE.md)
- **Detailed specs**: See [ALGORITHMS_COMPLETE.md](./ALGORITHMS_COMPLETE.md)
- **Issues/Bugs**: [GitHub Issues](https://github.com/yfedoseev/sketch_oxide/issues)

---

**Release Date**: December 13, 2025
**Status**: Stable Release ✓
**Test Coverage**: 150+ unit tests per language
**Code Quality**: Production-ready
